<!DOCTYPE html>
<html lang="en">
<head>
      <meta charset="UTF-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <script src="https://kit.fontawesome.com/8f9e2dfbe3.js" crossorigin="anonymous"></script>
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" type="text/css" href="static/css/home.css"/>
      <script src="https://code.jquery.com/jquery.js"></script>
      <title>Tables</title>
</head>
<body>

      <div class="container-primary bg-style">
            <div class="container-overlay bg-style">
                  <div class="tables-wrapper">
                        <header class="row">
                              <div class="header-logo">
                                   <p class="logo" style="color: #ae85bf;">slate</p>
                             </div>
                             <button class="header-icon"><i class="far fa-edit" style="color: #ae85bf;"></i></span></button>
                        
                                   </header>
                        <div class="tables-dashboard">
                              <div class="db-content">
                        
                                    <!--Current Tables -->
                                    <div class="data-reservations">
                                                <h1 class="db-title">Reservations</h1>
                        
                                                 <div id="tableSelection"> </div>
                                           </div>
                        
                                    <!--Waiting List -->
                                    <div class="data-waitlist">
                                          <h1 class="db-title">Waitlist</h1>
                                          <div class="wait-data-list">
                        
                                          </div>
                                    </div>
                              </div>
                                                <div class="button-container"><a href ="#" id='clear'>Clear Reservations</a></div>
                        
                          
                                    </div>
                              </div>
                        

                        <nav class = "nav--tables">
                              <div class="nav-content row">
                                    <button class="nav-button" id="home-btn"><a href="/"><i class="fas fa-home fa-2x" style="color: #C9C7C7;"></i></a>
                                    </button>
                                    <button class="nav-button is-active" id="tables-list-btn"><a href="/tables"><i class="fas fa-th-large fa-2x" style="color:#C0A4CB"></i></a>
                                    </button>
                                    <button class="nav-button" id="add-res-btn"><a href="/reserve"><i class="fas fa-plus-square fa-2x" style="color: #C9C7C7;"></i></i></a>
                                    </button>
                              </nav>
                  </div>
            </div>
</body>

<script>
      function runTableQuery(){
      var currentURL = window.location.origin;

      $.ajax({
            url: currentURL + '/api/tables',
            method: "GET"
      })
      .done(function(tableData){
            console.log("-------------------")
            console.log("URL: " + currentURL + "/api/tables")
            console.log("-------------------")
            console.log(tableData)
            console.log("-------------------")


            for(var i =0; i < tableData.tableArray.length; i++){

                  console.log("Loop Data: ", tableData.tableArray[i])

                  var tableSelection = $('<div>');
                  tableSelection.addClass('db-data reservations row');
                  tableSelection.attr('id', 'tableRes-' + i+1);
                  $('#tableSelection').append(tableSelection)

                  var tableNumber  =  i  +  1;

                  if(tableNumber < 10){
                    
                      tableNumber = "0" + tableNumber
                  }
                  $('#tableRes-' + i+1).append('<div class="res-position"> '+ tableNumber + '</div><div class="text-content"><h3 class="data-title">' + tableData.tableArray[i].customerFirst+ " " + tableData.tableArray[i].customerLast + '</h3><p class="data-result-primiary party">Party Size / '+  tableData.tableArray[i].customerParty+ '</p></div>' )
            }
      })
}

function runWaitQuery(){

      var currentURL = window.location.origin;

      $.ajax({
            url: currentURL + '/api/waitlist',
            method: "GET"
      })
      .done(function(waitListData){

            console.log("-------------------")
            console.log("URL: " + currentURL + "/api/waitlist")
            console.log("-------------------")
            console.log("waitListData: ", waitListData)
            console.log("-------------------")

            for(var i = 0; i < waitListData.waitingArray.length; i++){

                  console.log(waitListData.waitingArray[i])

                  var waitSelection = $('<div>');
                  waitSelection.addClass('waitlist-data');
                  waitSelection.attr('id', 'waitRes-' + i +1)
                  $('.wait-data-list').append(waitSelection)

                  var waitingNum = i + 1;
                  $('#waitRes-' + i+1).append('<div class="wait-item"> <span class="wait-position">' + waitingNum + '</span> <span class=" text-content wait-name">'+ waitListData.waitingArray[i].customerFirst + " " + waitListData.waitingArray[i].customerLast + '<span class="wait-party-size"> / '+ waitListData.waitingArray[i].customerParty+' </span> </div>');
                  }
      })
}



function clearTable() {
      var currentURL = window.location.origin;
      $.ajax({url: currentURL + "/api/clear", method: "POST"})
    }
  
    $('#clear').on('click', function() {
      alert("Clearing...");
      clearTable();
      location.reload();
    })

runTableQuery()
runWaitQuery()
  
</script>


    

</html>